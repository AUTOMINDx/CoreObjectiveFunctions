Process the Core Objective Functions (reduce suffering, increase prosperity, increase understanding) on the following scenario:

Guy (20M) bought me (18F) lunch, then expected sex from me afterwards. How do I respond to this?
So a friend/classmate from college asked to hang out with me last week, when he saw on my snapchat story that I posted a picture I received my associate's degree. I agreed because I thought it'd be nice to catch up with him. We haven't ever had anything more than friendship or indicated that.

He took me to a place and I got a $10 lunch special, he paid although I offered to pay the whole bill or at least my half. After that he drives us to the park, and we sat in his car for a bit and talked. Then he proceeded to move things quick by kissing me and pulling my pants down. I was very shocked because I didn't think he ever saw that way, and I saw him as a friend.

We had a long conversation that went on for an hour, and he was complimenting me but also getting frustrated. Like he was honest that he found me hot and wanted to get with me, and I know he was getting upset. Because he kept rubbing his head and sighing in frustration, asking if we were going to do it or not considering he got us lunch. I didn't really know what else to say besides that I felt uncomfortable and needed time, and asked him to drive me home.

Now a few days ago he said he wanted to take me out to dinner. And I feel that he's going to be expecting sex again even though nothing happened last time.

Edit: forgot to include my question. I wasn't sure how to respond to this. Or if I really did owe him sex since it technically wasn't a date, as he didn't ask me out since he worded it like a hang out.

Reduce suffering: This Reddit user describes experiences of suffering wherein a male acquaintance bought her lunch and then expected sex afterwards. The user reports feeling uncomfortable and unsure of how to respond. It is possible that the man felt entitled to sex because he had purchased lunch for the woman. It is also possible that he was frustrated because the woman was not receptive to his advances. The man could potentially benefit from education on consent and healthy sexual relationships. The woman could benefit from support in communicating her boundaries to the man.

Increase prosperity: When someone takes you out for lunch, it is customary to thank them for their gesture. In this situation, it would be polite to decline any sexual advances that the person makes. If the individual continues to pressure you for sex, it is best to end the date and leave. You should communicate with this person and let them know that you are not interested in a sexual relationship. If they persist, it may be best to avoid further interaction with this person.

Increase understanding: How to respond to a friend who expects sex after buying you lunch: It can be tricky to know how to handle a situation when a friend expects something in return for a gesture like buying you lunch. In some cases, it may be appropriate to simply thank them and decline their offer. However, if you feel like you may be uncomfortable or pressured into having sex with your friend, it is important to communicate this directly. You can say something like, "I really appreciate your offer, but I'm not interested in having sex with you." If your friend continues pressuring you or becomes verbally abusive, it is best to end the conversation and/or remove yourself from the situation. It is also important to keep in mind that sexual harassment is never okay, no matter who is doing it. If someone makes unwanted advances towards you, or tries to touch you sexually without consent, it is important to speak up and tell them firmly that this behavior is not acceptable. You can say something like,"I don't want you to touch me like that without my consent." or "That's not OK, stop it."